<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ApplwNgoo Iphone</title>
    
    <style>
        /* CSS Variables for theming */
        :root {
            --bg-color: #f0f2f5;
            --text-color: #050505;
            --card-bg: #ffffff;
            --header-bg: #ffffff;
            --border-color: #ddd;
            --fb-blue: #1877f2;
            --input-bg: #e4e6eb;
            --input-border: #ddd;
            --action-btn-bg: #e4e6eb;
            --action-btn-text: #000;
        }

        .night-mode {
            --bg-color: #1a1a1a; /* Dark background */
            --text-color: #e4e6eb; /* Light text */
            --card-bg: #242526; /* Darker card background */
            --header-bg: #242526; /* Darker header */
            --border-color: #3e4042; /* Darker borders */
            --fb-blue: #2d88ff; /* Slightly different blue for dark mode */
            --input-bg: #3a3b3c; /* Dark input background */
            --input-border: #3a3b3c; /* Dark input border */
            --action-btn-bg: #3a3b3c;
            --action-btn-text: #e4e6eb;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: var(--bg-color); 
            margin: 0;
            font-family: Arial, sans-serif;
            transition: background-color 0.3s ease; /* Smooth transition for theme change */
        }

        /* 1. The Phone's Outer Body */
        .iphone-container {
            position: relative;
        }

        .iphone-frame {
            width: 390px;
            height: 800px;
            background: #000; 
            border: 10px solid #222; 
            border-radius: 60px;
            box-shadow: 
                0 20px 50px rgba(0, 0, 0, 0.5), 
                inset 0 0 10px rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden; 
        }

        /* 2. The Screen Area */
        .screen {
            width: 100%;
            height: 100%;
            background: var(--card-bg); /* Screen background uses card_bg for theme */
            border-radius: 50px; 
            position: relative;
            overflow-y: scroll; 
            overflow-x: hidden;
            transition: background-color 0.3s ease;
        }
        
        /* Hide scrollbar for aesthetics */
        .screen::-webkit-scrollbar {
            display: none;
        }
        .screen {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }


        /* 3. Dynamic Island Base Position */
        .dynamic-island-wrapper {
            position: absolute;
            width: 100%;
            padding-top: 15px; 
            text-align: center;
            z-index: 10;
        }

        #dynamic-island {
            display: inline-flex; 
            align-items: center;
            justify-content: center;
            background: #000;
            color: white;
            border-radius: 20px; 
            transition: all 0.3s ease-in-out; 
            cursor: pointer;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
        }

        #vietnam-time {
            /* Ensure the clock starts white, ready for color change */
            color: white; 
        }

        .island-collapsed {
            width: 120px;
            height: 32px;
        }
        
        .island-expanded {
            width: 350px; 
            height: 90px;
            border-radius: 40px;
        }

        #island-content {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            padding: 0 8px;
            width: 100%;
            justify-content: space-between;
            transition: opacity 0.3s ease;
        }

        #audio-visualizer {
            display: none; 
            width: 100px; 
            height: 50px;
            border-radius: 10px;
            background: #1a1a1a;
        }
        
        @keyframes pulse {
            0% { transform: scaleY(1); opacity: 0.8; }
            50% { transform: scaleY(1.2); opacity: 1; }
            100% { transform: scaleY(1); opacity: 0.8; }
        }
        .simulated-soundwave {
            animation: pulse 1s infinite alternate;
            /* Gradient set via JS */
        }

        /* --- FACEBOOK APP STYLING --- */

        .facebook-app {
            padding-top: 55px; 
            height: calc(100% - 55px);
            background-color: var(--bg-color); 
            transition: background-color 0.3s ease;
        }

        .fb-header {
            background-color: var(--header-bg); 
            padding: 10px 15px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            position: sticky; 
            top: 0;
            z-index: 5;
            transition: background-color 0.3s ease;
        }

        .fb-logo {
            font-size: 26px;
            font-weight: bold;
            color: var(--fb-blue); 
            text-align: left;
        }

        .fb-post-card {
            background-color: var(--card-bg);
            margin: 10px 0;
            padding: 15px;
            border-top: 1px solid var(--border-color);
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .post-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .profile-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
            object-fit: cover;
            border: 1px solid #eee;
        }

        .user-details {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }

        .user-name {
            font-weight: 700;
            font-size: 14px;
            color: var(--text-color); 
            margin-right: 5px;
            transition: color 0.3s ease;
        }
        
        /* New styling for the verified tick using SVG for accuracy */
        .verified-tick {
            display: inline-block;
            width: 16px; 
            height: 16px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%231877F2' d='M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm4.707 7.707-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 1 1 1.414-1.414L11.5 12.086l3.293-3.293a1 1 0 0 1 1.414 1.414z'/%3E%3C/svg%3E");
            background-size: cover;
            margin-top: -3px; 
            margin-left: 2px;
            flex-shrink: 0; 
            transition: filter 0.3s ease; 
        }

        .post-time {
            font-size: 12px;
            color: #606770; 
            width: 100%; 
        }

        .post-content {
            margin-bottom: 15px;
        }

        #video-player {
            background-color: #000;
            height: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 14px;
            margin-bottom: 10px;
        }

        #video-player iframe {
            display: block;
        }

        #target-text {
            font-size: 18px;
            font-weight: bold;
            padding: 10px 0;
            color: var(--text-color); 
            transition: color 0.3s ease; 
        }

        .post-actions-bar {
            padding-top: 10px;
            border-top: 1px solid var(--border-color);
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            transition: border-color 0.3s ease;
        }

        .action-btn {
            background-color: var(--action-btn-bg);
            color: var(--action-btn-text);
            border: none;
            padding: 6px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: background-color 0.2s, color 0.2s;
        }

        .action-btn:hover {
            background-color: var(--border-color); 
        }

        .video-btn, .avatar-btn {
            background-color: var(--fb-blue);
            color: white;
        }

        .video-btn:hover, .avatar-btn:hover {
            background-color: #166fe5; 
        }

        #youtube-link-input {
            flex-grow: 1; 
            padding: 6px;
            border: 1px solid var(--input-border);
            border-radius: 6px;
            font-size: 12px;
            background-color: var(--input-bg);
            color: var(--text-color);
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
        }

        #name-color-input, #tick-color-input {
            width: 80px;
            padding: 4px;
            border: 1px solid var(--input-border);
            border-radius: 4px;
            background-color: var(--input-bg);
            color: var(--text-color);
        }

    </style>
</head>
<body class=""> 
    <div class="iphone-container">
        <div class="iphone-frame">
            <div class="screen">
                
                <div class="dynamic-island-wrapper">
                    <div id="dynamic-island" class="island-collapsed">
                        <div id="island-content">
                            <span id="vietnam-time">10:09</span>
                            <canvas id="audio-visualizer"></canvas> 
                        </div>
                    </div>
                </div>
                
                <div class="facebook-app">
                    
                    <div class="fb-header">
                        <h1 class="fb-logo">facebook</h1>
                    </div>

                    <div class="fb-post-card">
                        
                        <div class="post-header">
                            <img id="avatar-image" src="https://via.placeholder.com/50/007bff/ffffff?text=TD" alt="User Avatar" class="profile-avatar">
                            <div class="user-details">
                                <span class="user-name" id="userName">ApplwNgoo</span>
                                <span class="verified-tick" id="verifiedTick" title="Verified"></span>
                                <p class="post-time">1 min ago</p>
                            </div>
                        </div>
                        
                        <div class="post-content">
                            <div id="video-player">
                                <p>Paste a YouTube link below and press 'Load Video'</p>
                            </div>
                            <h3 id="target-text">Iphone c·ªßa b·∫°n!</h3>
                        </div>
                        
                        <div class="post-actions-bar">
                            
                            <button id="change-name-btn" class="action-btn avatar-btn">üë§ ƒê·ªïi t√™n FB</button>
                            <input type="file" id="avatar-file-input" accept="image/*" style="display: none;">
                            <button id="upload-avatar-btn" class="action-btn avatar-btn">üì∑ ƒê·ªïi Avatar</button>
                            
                            <button id="rgb-header-btn" class="action-btn video-btn">üåà T√™n Rainbow</button>

                            <div class="color-buttons">
                                <button id="rainbow-text-btn" class="action-btn">üåà Rainbow</button>
                                <button id="rgb-text-btn" class="action-btn">üé® RGB </button>
                                <button id="random-text-btn" class="action-btn">üé≤ Random</button>
                            </div>
                            
                            <input type="text" id="youtube-link-input" placeholder="Paste YouTube Link">
                            <button id="load-video-btn" class="action-btn video-btn">‚ñ∂ Load Video</button>
                            
                            <button id="toggle-night-mode-btn" class="action-btn">üåô Night Mode</button>
                            
                            <div style="width: 100%; display: flex; gap: 8px; margin-top: 5px; align-items: center;">
                                <label for="name-color-input" style="font-size: 12px; color: var(--text-color);">M√†u t√™n:</label>
                                <input type="color" id="name-color-input" value="#050505">
                                <label for="tick-color-input" style="font-size: 12px; color: var(--text-color);">M√†u tick:</label>
                                <input type="color" id="tick-color-input" value="#1877f2">
                            </div>
                        </div>
                        
                    </div>
                    
                </div>
                
            </div>
        </div>
    </div>

    <script>
        // --- Element Selection ---
        const body = document.body;
        const island = document.getElementById('dynamic-island');
        const timeDisplay = document.getElementById('vietnam-time');
        const visualizerCanvas = document.getElementById('audio-visualizer');
        const youtubeLinkInput = document.getElementById('youtube-link-input');
        const loadVideoBtn = document.getElementById('load-video-btn');
        const videoPlayerDiv = document.getElementById('video-player');
        
        // --- NEW/UPDATED Elements ---
        const changeNameBtn = document.getElementById('change-name-btn'); // NEW
        const uploadAvatarBtn = document.getElementById('upload-avatar-btn'); // NEW
        const avatarFileInput = document.getElementById('avatar-file-input'); // NEW
        const avatarImage = document.getElementById('avatar-image'); // Existing element
        const userNameSpan = document.getElementById('userName'); // Existing element

        // --- Color Elements ---
        const targetText = document.getElementById('target-text');
        const rainbowBtn = document.getElementById('rainbow-text-btn');
        const rgbBtn = document.getElementById('rgb-text-btn');
        const randomBtn = document.getElementById('random-text-btn');
        const toggleNightModeBtn = document.getElementById('toggle-night-mode-btn');
        const rgbHeaderBtn = document.getElementById('rgb-header-btn'); 
        const verifiedTickSpan = document.getElementById('verifiedTick');
        const nameColorInput = document.getElementById('name-color-input');
        const tickColorInput = document.getElementById('tick-color-input');

        // --- State Variables ---
        let rgbInterval;
        let headerRgbInterval; 
        let soundwaveColorInterval;
        let isNightMode = false;
        let hue = 0;


        // ===================================
        // --- NEW NAME AND AVATAR LOGIC ---
        // ===================================

        // 1. Change Name Function
        changeNameBtn.addEventListener('click', () => {
            const newName = prompt('Enter the new name for your Facebook profile:');
            
            if (newName && newName.trim() !== "") {
                userNameSpan.textContent = newName.trim();
            } else if (newName !== null) {
                alert('Name cannot be empty.');
            }
        });

        // 2. Avatar File Uploader (Local File Upload)
        uploadAvatarBtn.addEventListener('click', () => {
            // Programmatically click the hidden file input
            avatarFileInput.click();
        });

        avatarFileInput.addEventListener('change', (event) => {
            const file = event.target.files[0];
            
            if (file) {
                // Check if the file is an image
                if (!file.type.startsWith('image/')) {
                    alert('Please select an image file.');
                    // Clear the file input
                    avatarFileInput.value = ''; 
                    return;
                }

                // FileReader reads the contents of the file
                const reader = new FileReader();
                
                reader.onload = (e) => {
                    // e.target.result contains the data URL (base64)
                    avatarImage.src = e.target.result;
                };
                
                // Read the file as a Data URL
                reader.readAsDataURL(file);
            }
        });

        // ===================================
        // --- EXISTING COLOR/THEME LOGIC ---
        // ===================================

        // --- Utility Functions ---
        function resetHeaderColors() {
            clearInterval(headerRgbInterval);
            headerRgbInterval = null;
            timeDisplay.style.color = 'white'; 
            updateNameAndTickColors();
        }

        // --- Custom Name and Tick Color Update (Used for inputs AND RGB cycle) ---
        function updateNameAndTickColors(nameColor, tickColor) {
            const newNameColor = nameColor || nameColorInput.value;
            const newTickColor = tickColor || tickColorInput.value;

            userNameSpan.style.color = newNameColor;
            
            // Recreate SVG background with the new tick color
            const svgData = encodeURIComponent(`
                <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'>
                    <path fill='${newTickColor}' d='M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm4.707 7.707-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 1 1 1.414-1.414L11.5 12.086l3.293-3.293a1 1 0 0 1 1.414 1.414z'/>
                </svg>
            `);
            verifiedTickSpan.style.backgroundImage = `url("data:image/svg+xml,${svgData}")`;
        }

        // --- Header RGB Cycle Logic ---
        function startHeaderRgbCycle() {
            if (headerRgbInterval) {
                resetHeaderColors(); 
                return;
            }

            let step = 0;
            headerRgbInterval = setInterval(() => {
                const r = Math.sin(step) * 127 + 128;
                const g = Math.sin(step + 2) * 127 + 128;
                const b = Math.sin(step + 4) * 127 + 128;
                
                const rgbString = `rgb(${Math.round(r)}, ${Math.round(g)}, ${Math.round(b)})`;

                timeDisplay.style.color = rgbString;
                updateNameAndTickColors(rgbString, rgbString);

                step += 0.05; 
            }, 50);
        }

        // --- Event Listeners for Custom Colors and Toggles ---
        nameColorInput.addEventListener('input', () => {
            resetHeaderColors();
            updateNameAndTickColors();
        });
        tickColorInput.addEventListener('input', () => {
            resetHeaderColors();
            updateNameAndTickColors();
        });
        rgbHeaderBtn.addEventListener('click', startHeaderRgbCycle); 

        updateNameAndTickColors(); // Initial call

        // --- Night Mode Toggle ---
        toggleNightModeBtn.addEventListener('click', () => {
            isNightMode = !isNightMode;
            body.classList.toggle('night-mode', isNightMode);
            toggleNightModeBtn.textContent = isNightMode ? '‚òÄÔ∏è Light Mode' : 'üåô Night Mode';
            resetHeaderColors(); 
            updateNameAndTickColors();
        });

        // --- Dynamic Island Logic (Soundwave Color & Toggle) ---
        function updateSoundwaveColor() {
            hue = (hue + 2) % 360; 
            const color1 = `hsl(${hue}, 100%, 50%)`;
            const color2 = `hsl(${(hue + 60) % 360}, 100%, 50%)`; 
            const color3 = `hsl(${(hue + 120) % 360}, 100%, 50%)`; 

            visualizerCanvas.style.backgroundImage = `linear-gradient(to right, ${color1}, ${color2}, ${color3}, ${color2}, ${color1})`;
        }

        function startSimulatedSoundwave() {
            visualizerCanvas.style.display = 'block'; 
            visualizerCanvas.classList.add('simulated-soundwave');
            
            if (!soundwaveColorInterval) {
                soundwaveColorInterval = setInterval(updateSoundwaveColor, 100); 
            }
        }
        
        function stopSimulatedSoundwave() {
            clearInterval(soundwaveColorInterval);
            soundwaveColorInterval = null;
            visualizerCanvas.classList.remove('simulated-soundwave');
            visualizerCanvas.style.display = 'none';
        }

        island.addEventListener('click', () => {
            island.classList.toggle('island-collapsed');
            island.classList.toggle('island-expanded');
            
            const isExpanded = island.classList.contains('island-expanded');
            
            if (isExpanded) {
                timeDisplay.style.display = 'block';
                if (videoPlayerDiv.querySelector('iframe')) {
                    startSimulatedSoundwave();
                }
            } else {
                stopSimulatedSoundwave();
            }
        });

        // --- Vietnam Time Display ---
        function updateVietnamTime() {
            const options = { 
                timeZone: 'Asia/Ho_Chi_Minh', 
                hour: '2-digit', 
                minute: '2-digit', 
                hour12: false 
            };
            const vnTime = new Date().toLocaleTimeString('en-US', options);
            timeDisplay.textContent = vnTime;
        }

        updateVietnamTime();
        setInterval(updateVietnamTime, 1000); 

        // --- YouTube Video Player and Link Loader ---
        loadVideoBtn.addEventListener('click', () => {
            const link = youtubeLinkInput.value.trim();
            if (!link) {
                alert('Please paste a valid YouTube link.');
                return;
            }

            let videoId;
            const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
            const match = link.match(regex);

            if (match && match[1]) {
                videoId = match[1];
            } else {
                videoPlayerDiv.innerHTML = `<p style="color: red;">Invalid YouTube link format.</p>`;
                return;
            }

            const iframeHTML = `<iframe width="100%" height="200" 
                src="https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0" 
                frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" 
                allowfullscreen></iframe>`;
                
            videoPlayerDiv.innerHTML = iframeHTML;
            
            if (island.classList.contains('island-expanded')) {
                startSimulatedSoundwave(); 
            }
        });

        // --- Text Color Manipulation Functions ---
        function resetText() {
            clearInterval(rgbInterval); 
            targetText.innerHTML = targetText.textContent; 
            targetText.style.color = getComputedStyle(document.documentElement).getPropertyValue('--text-color'); 
        }

        // A. Rainbow Text (Static Gradient)
        function setRainbowText(element) {
            resetText();
            const text = element.textContent;
            element.innerHTML = [...text].map((char, i) => {
                const hue = i * (360 / text.length);
                return `<span style="color: hsl(${hue}, 100%, 50%);">${char}</span>`;
            }).join('');
        }

        // B. RGB Cycle Text (Animated)
        function setRgbCycleText(element) {
            resetText();
            let step = 0;

            rgbInterval = setInterval(() => {
                const text = element.textContent;
                element.innerHTML = [...text].map((char, i) => {
                    const r = Math.sin(0.1 * i + step) * 127 + 128;
                    const g = Math.sin(0.1 * i + step + 2) * 127 + 128;
                    const b = Math.sin(0.1 * i + step + 4) * 127 + 128;
                    
                    return `<span style="color: rgb(${Math.round(r)}, ${Math.round(g)}, ${Math.round(b)});">${char}</span>`;
                }).join('');
                
                step += 0.1; 
            }, 50); 
        }

        // C. Random Color Text (Static Random)
        function setRandomText(element) {
            resetText();
            const text = element.textContent;
            
            const randomColor = () => '#' + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0');

            element.innerHTML = [...text].map((char) => {
                return `<span style="color: ${randomColor()};">${char}</span>`;
            }).join('');
        }

        // Attach Event Listeners to Buttons
        rainbowBtn.addEventListener('click', () => setRainbowText(targetText));
        rgbBtn.addEventListener('click', () => setRgbCycleText(targetText));
        randomBtn.addEventListener('click', () => setRandomText(targetText));
    </script>
</body>
</html>
</body>
</html>
