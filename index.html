<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Applw</title>
<style>
/* ====== Theme n·ªÅn t·ªëi ====== */
body{margin:0;background:#02040a;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;text-align:center;overflow-x:hidden;}
.card{margin:20px auto;padding:16px;width:min(92%,820px);background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);border-radius:20px;backdrop-filter:blur(10px);}

/* ====== N√∫t & input ====== */
.btn{background:#141826;border:none;border-radius:10px;color:#fff;padding:10px 14px;margin:6px;cursor:pointer;font-weight:600;box-shadow:0 6px 16px rgba(0,0,0,.35);}
.btn:hover{background:#23283d}
input[type=file]{display:none}

/* ====== Tick xanh (verified badge) ====== */
:root{
  --verify-a:#1fa2ff;
  --verify-mid:#12d8fa;
  --verify-b:#1d8cf8;
}
.v-badge{
  display:inline-grid;place-items:center;
  width:18px;height:18px;margin-left:6px;border-radius:50%;
  background:linear-gradient(135deg,var(--verify-a),var(--verify-mid) 50%,var(--verify-b));
  color:#fff; /* check mark d√πng currentColor */
  box-shadow:0 0 0 2px rgba(255,255,255,.25);
}
.v-badge--lg{width:22px;height:22px;margin-left:8px}
.v-badge svg{width:60%;height:60%}
@keyframes tickGlow{
  0%{filter:hue-rotate(0);box-shadow:0 0 8px #1fa2ff}
  50%{filter:hue-rotate(180deg);box-shadow:0 0 16px #12d8fa}
  100%{filter:hue-rotate(360deg);box-shadow:0 0 8px #1fa2ff}
}
.v-badge--flash{animation:tickGlow 2.5s linear infinite}
@media (prefers-reduced-motion:reduce){.v-badge--flash{animation:none}}

/* ====== iPhone khung & m√†n h√¨nh ====== */
.iphone{
  position:relative;width:min(360px,92vw);aspect-ratio:9/19.5;
  border-radius:45px;background:#000;box-shadow:0 20px 60px rgba(0,0,0,.9);overflow:hidden;margin:18px auto;
}
.iphone__screen{position:absolute;inset:10px;border-radius:35px;background:#111;display:flex;flex-direction:column;overflow:hidden}

/* ====== Dynamic Island + Soundwave ====== */
.island{
  position:absolute;top:12px;left:50%;transform:translateX(-50%);
  width:160px;height:36px;background:#000;border-radius:18px;
  display:flex;align-items:center;justify-content:center;
  transition:all .35s ease;overflow:hidden;z-index:2;
}
.island.expanded{width:88%;height:130px;border-radius:30px;background:#0c0c0c;flex-direction:column;padding:10px}
.island-expanded{display:none}
.island.expanded .island-expanded{display:block}
.island.expanded .island-compact{display:none}
.grad{background:linear-gradient(90deg,#ff4fa8,#57ff9a);-webkit-background-clip:text;color:transparent}

/* Visualizer bars */
.visualizer{width:92%;height:34px;margin:8px auto 0;display:flex;align-items:flex-end;gap:3px}
.visualizer div{
  flex:1; height:8px; border-radius:2px;
  background:linear-gradient(180deg,#57ff9a,#ff4fa8);
  transition:height .05s linear, background .4s ease;
}

/* ====== Facebook mock ====== */
.fb-header{display:flex;justify-content:space-between;align-items:center;padding:10px 14px;background:#0e0e0e;border-bottom:1px solid #222}
.logo-badge{background:#1877f2;color:#fff;font-weight:900;font-size:20px;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center}
.fb-composer{display:flex;align-items:center;gap:10px;padding:10px;border-bottom:1px solid #222;background:#0b0b0b}
.avatar-sm{width:36px;height:36px;border-radius:50%;object-fit:cover;background:#1c1c1c}
.fake-input{flex:1;color:#cfd6ff}
.fb-post{padding:10px;text-align:left;border-bottom:1px solid #222;background:#0c0c0c}
.post-head{display:flex;align-items:center;gap:8px}
.name{font-weight:800}
.time{font-size:12px;opacity:.8}
.post-media{border-radius:12px;background:#000;overflow:hidden;margin-top:10px}
.video-wrap{position:relative;width:100%}
.video-wrap::before{content:"";display:block;padding-top:56.25%}
.video-wrap video,.video-wrap iframe{position:absolute;inset:0;width:100%;height:100%;border:none;background:#000}
.placeholder{display:grid;place-items:center;color:#8c8c8c;padding:24px}
</style>
</head>
<body>
  <div class="card">
    <h1>ApplwNgoo</h1>
    <p>Gi·ªù Vi·ªát Nam tr√™n Dynamic Island ¬∑ Video MP4 ph√°t trong b√†i ƒëƒÉng ¬∑ Soundwave theo √¢m thanh video.</p>
    <div>
      <label class="btn" for="videoInput">Ch·ªçn video MP4</label>
      <input id="videoInput" type="file" accept="video/mp4,video/*">
      <label class="btn" for="avatarInput">ƒê·ªïi avatar</label>
      <input id="avatarInput" type="file" accept="image/*">
      <button class="btn" id="expandIsland">M·ªü/thu Dynamic Island</button>
    </div>
  </div>

  <!-- iPhone -->
  <div class="iphone">
    <!-- Dynamic Island -->
    <div class="island" id="island" title="Ch·∫°m ƒë·ªÉ m·ªü/thu g·ªçn">
      <div class="island-compact">
        <span id="vnClock" class="grad">--:--:--</span>
      </div>
      <div class="island-expanded">
        <div class="grad" id="vnClockBig" style="font-weight:700">--:--:--</div>
        <div class="grad" id="vnDate" style="opacity:.9">--/--/----</div>
        <div id="visualizer" class="visualizer" aria-hidden="true"></div>
      </div>
    </div>

    <!-- M√†n h√¨nh Facebook -->
    <div class="iphone__screen">
      <div class="fb-header">
        <div class="logo-badge">f</div>
        <div style="opacity:.6">Facebook</div>
      </div>

      <div class="fb-composer">
        <img id="composerAvatar" class="avatar-sm" alt="">
        <div class="fake-input">B·∫°n ƒëang nghƒ© g√¨?</div>
      </div>

      <div class="fb-post">
        <div class="post-head">
          <img id="postAvatar" class="avatar-sm" alt="">
          <div>
            <div class="name">
             ApplwNgoo
              <!-- Tick xanh g·∫Øn sau t√™n -->
              <span class="v-badge v-badge--lg v-badge--flash" title="ƒê√£ x√°c minh" aria-label="ƒê√£ x√°c minh">
                <svg viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M6 12l3.5 3.5L18 7"
                        fill="none" stroke="currentColor"
                        stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </span>
            </div>
            <div class="time" id="postTime">V·ª´a xong ¬∑ üåê</div>
          </div>
        </div>

        <div class="post-media" id="postMedia">
          <div id="placeholder" class="placeholder">Ch∆∞a c√≥ video ‚Äî h√£y b·∫•m <b>Ch·ªçn video MP4</b>.</div>
        </div>
      </div>
    </div>
  </div>

<script>
/* ===== VN time (Asia/Ho_Chi_Minh) ===== */
function vnNow(){
  try{
    return new Date(new Date().toLocaleString("en-US",{timeZone:"Asia/Ho_Chi_Minh"}));
  }catch{
    const n=new Date(); return new Date(n.getTime()+n.getTimezoneOffset()*60000+7*3600000);
  }
}
const two = n => String(n).padStart(2,"0");
function updateVN(){
  const t=vnNow(); const hh=two(t.getHours()), mm=two(t.getMinutes()), ss=two(t.getSeconds());
  const d=two(t.getDate()), mo=two(t.getMonth()+1), y=t.getFullYear();
  vnClock.textContent = `${hh}:${mm}:${ss}`;
  vnClockBig.textContent = `${hh}:${mm}:${ss}`;
  vnDate.textContent = `${d}/${mo}/${y}`;
  postTime.textContent = `V·ª´a xong ¬∑ üåê ¬∑ ${d}/${mo}/${y} ${hh}:${mm}`;
}
setInterval(updateVN,1000); updateVN();

/* ===== Dynamic Island toggle ===== */
const island = document.getElementById("island");
island.addEventListener("click", ()=> island.classList.toggle("expanded"));
document.getElementById("expandIsland").addEventListener("click", ()=> island.classList.toggle("expanded"));

/* ===== Avatar m·∫∑c ƒë·ªãnh + ƒë·ªïi avatar ===== */
function defaultAvatar(initials="BPN"){
  const svg=`<svg xmlns='http://www.w3.org/2000/svg' width='256' height='256'>
    <defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='1'>
      <stop offset='0%' stop-color='#ff62a5'/><stop offset='100%' stop-color='#57ff9a'/>
    </linearGradient></defs>
    <rect width='100%' height='100%' fill='url(#g)'/>
    <text x='50%' y='58%' text-anchor='middle' font-size='110' font-family='Arial' fill='white' font-weight='700'>${initials}</text>
  </svg>`;
  return "data:image/svg+xml;utf8,"+encodeURIComponent(svg);
}
composerAvatar.src = postAvatar.src = defaultAvatar();
document.getElementById("avatarInput").addEventListener("change",e=>{
  const f=e.target.files?.[0]; if(!f) return;
  const url=URL.createObjectURL(f);
  composerAvatar.src = postAvatar.src = url;
});

/* ===== Video v√†o b√†i post + Visualizer trong Dynamic Island ===== */
const postMedia = document.getElementById("postMedia");
const videoInput = document.getElementById("videoInput");
let audioCtx=null, analyser=null, srcNode=null, rafId=null;

videoInput.addEventListener("change", e=>{
  const f=e.target.files?.[0]; if(!f) return;
  const url=URL.createObjectURL(f);
  showVideo(url);
});

function clearMedia(){
  postMedia.innerHTML="";
  if(rafId) cancelAnimationFrame(rafId);
  rafId=null;
  try{ if(audioCtx) audioCtx.close(); }catch{}
  audioCtx=analyser=srcNode=null;
}

function showVideo(url){
  clearMedia();
  const wrap=document.createElement("div");
  wrap.className="video-wrap";
  const v=document.createElement("video");
  v.src=url; v.controls=true; v.autoplay=true; v.loop=true; v.playsInline=true;
  wrap.appendChild(v); postMedia.appendChild(wrap);
  v.addEventListener("loadeddata", ()=>{ v.play().catch(()=>{}); startVisualizer(v); }, {once:true});
}

/* ===== Soundwave: t·∫°o 24 c·ªôt trong Island ===== */
function ensureBars(){
  const vsl=document.getElementById("visualizer");
  if(vsl.children.length) return [...vsl.children];
  const frag=document.createDocumentFragment();
  for(let i=0;i<24;i++){ const bar=document.createElement("div"); frag.appendChild(bar); }
  vsl.appendChild(frag);
  return [...vsl.children];
}

function startVisualizer(mediaEl){
  const bars = ensureBars();

  // Kh·ªüi Web Audio
  audioCtx = new (window.AudioContext||window.webkitAudioContext)();
  srcNode = audioCtx.createMediaElementSource(mediaEl);
  analyser = audioCtx.createAnalyser();
  analyser.fftSize = 64;              // √≠t c·ªôt -> m∆∞·ª£t
  analyser.smoothingTimeConstant = .85;

  srcNode.connect(analyser);
  // Kh√¥ng b·∫Øt bu·ªôc n·ªëi ra loa, v√¨ <video> t·ª± ph√°t ‚Äî ch·ªâ ph√¢n t√≠ch d·ªØ li·ªáu
  // analyser.connect(audioCtx.destination); // n·∫øu mu·ªën ‚Äúb·∫£o ƒë·∫£m‚Äù ph√°t qua AudioContext

  const buf = new Uint8Array(analyser.frequencyBinCount);

  const loop = () => {
    rafId = requestAnimationFrame(loop);
    analyser.getByteFrequencyData(buf);

    for(let i=0;i<bars.length;i++){
      // L·∫•y nƒÉng l∆∞·ª£ng d·∫£i t·∫ßn, scale chi·ªÅu cao
      const h = Math.max(4, buf[i] / 3);
      bars[i].style.height = `${h}px`;

      // M√†u bar: ƒë·ªìng b·ªô tick xanh nh∆∞ng h∆°i ƒë·ªïi t√¥ng theo index
      const hueShift = (i*8 + performance.now()/20) % 360;
      // L·∫•y m√†u n·ªÅn tick t·ª´ bi·∫øn, nh∆∞ng th√™m hue shift nh·∫π
      bars[i].style.background = `linear-gradient(180deg, hsl(${(120+hueShift)%360} 90% 60%), hsl(${(320+hueShift)%360} 90% 60%))`;
    }
  };
  loop();
}

/* ===== Tr·ª£ nƒÉng: n·∫øu kh√¥ng c√≥ video, v·∫´n cho ƒë·∫£o n·ªü/thu ===== */
// (ƒê√£ c√≥ m·∫∑c ƒë·ªãnh ·ªü toggle ph√≠a tr√™n)
</script>
</body>
</html>


